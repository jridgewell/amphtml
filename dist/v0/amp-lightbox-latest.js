(window.AMP = window.AMP || []).push(function(AMP) {var process={env:{NODE_ENV:"production"}};var h="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;function l(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(h.Object.defineProperties){var e=h.Object.getOwnPropertyDescriptor(b,d);void 0!==e&&h.Object.defineProperty(a,d,e)}else a[d]=b[d]};var m=null,p="";var q=(new Date).getTime();function r(a,b,c){this.win=a.AMP_TEST?a.parent:a;this.levelFunc_=b;this.level_=this.calcLevel_();this.suffix_=c||""}
r.prototype.calcLevel_=function(){var a;if(m)a=m;else{if(window.context&&window.context.mode)a=window.context.mode;else{a=("localhost"==location.hostname||location.ancestorOrigins&&location.ancestorOrigins[0]&&0==location.ancestorOrigins[0].indexOf("http://localhost:"))&&!!document.querySelector('script[src*="/dist/"],script[src*="/base/"]');var b=location.originalHash||location.hash,c=Object.create(null);if(b){if(0==b.indexOf("?")||0==b.indexOf("#"))b=b.substr(1);for(var b=b.split("&"),d=0;d<b.length;d++){var e=
b[d],f=e.indexOf("="),k=void 0,n=void 0;-1!=f?(k=decodeURIComponent(e.substring(0,f)).trim(),n=decodeURIComponent(e.substring(f+1)).trim()):(k=decodeURIComponent(e).trim(),n="");k&&(c[k]=n)}}p||(p=a?"1463506055389":window.AMP_CONFIG&&window.AMP_CONFIG.v?window.AMP_CONFIG.v:"1463506055389");a={localDev:a,development:"1"==c.development||window.AMP_DEV_MODE,filter:c.filter,minified:"production"==process.env.NODE_ENV,test:window.AMP_TEST,log:c.log,version:p}}a=m=a}return this.win.console&&
this.win.console.log&&"0"!=a.log?this.win.ENABLE_LOG?4:a.localDev&&!a.log?3:this.levelFunc_(a):0};r.prototype.msg_=function(a,b,c){if(0!=this.level_){var d=this.win.console.log;"ERROR"==b?d=this.win.console.error||d:"INFO"==b?d=this.win.console.info||d:"WARN"==b&&(d=this.win.console.warn||d);c.unshift((new Date).getTime()-q,"["+a+"]");d.apply(this.win.console,c)}};r.prototype.isEnabled=function(){return 0!=this.level_};
r.prototype.fine=function(a,b){4<=this.level_&&this.msg_(a,"FINE",Array.prototype.slice.call(arguments,1))};r.prototype.info=function(a,b){3<=this.level_&&this.msg_(a,"INFO",Array.prototype.slice.call(arguments,1))};r.prototype.warn=function(a,b){2<=this.level_&&this.msg_(a,"WARN",Array.prototype.slice.call(arguments,1))};
r.prototype.error=function(a,b){if(1<=this.level_)this.msg_(a,"ERROR",Array.prototype.slice.call(arguments,1));else{var c=t.apply(null,Array.prototype.slice.call(arguments,1));this.prepareError_(c);this.win.setTimeout(function(){throw c;})}};r.prototype.createError=function(a){var b=t.apply(null,arguments);this.prepareError_(b);return b};
r.prototype.assert=function(a,b,c){var d=void 0;if(!a){var e=(b||"Assertion failed").split("%s"),f=e.shift(),k=f,n=[];""!=f&&n.push(f);for(f=2;f<arguments.length;f++){var g=arguments[f];g&&g.tagName&&(d=g);var v=e.shift();n.push(g);var C=v.trim();""!=C&&n.push(C);g=g instanceof Element?g.tagName.toLowerCase()+(g.id?"#"+g.id:""):g;k+=g+v}e=Error(k);e.fromAssert=!0;e.associatedElement=d;e.messageArray=n;this.prepareError_(e);throw e;}return a};
r.prototype.assertEnumValue=function(a,b,c){for(var d in a)if(a[d]==b)return a[d];this.assert(!1,'Unknown %s value: "%s"',c||"enum",b)};r.prototype.prepareError_=function(a){this.suffix_&&(a.message?-1==a.message.indexOf(this.suffix_)&&(a.message+=this.suffix_):a.message=this.suffix_)};function t(a){for(var b=null,c="",d=0;d<arguments.length;d++){var e=arguments[d];e instanceof Error&&!b?b=e:(c&&(c+=" "),c+=e)}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}
var u=new r(window,function(a){var b=parseInt(a.log,10);return a.development||1<=b?4:0},"\u200b\u200b\u200b");new r(window,function(a){a=parseInt(a.log,10);return 3<=a?4:2<=a?3:0});function w(a,b,c){var d=a.services;d||(d=a.services={});var e=d[b];e||(e=d[b]={obj:null,promise:null,resolve:null});e.obj||(e.obj=c(a),e.promise||(e.promise=Promise.resolve(e.obj)),e.resolve&&e.resolve(e.obj));return e.obj};function x(a){this.win=a;this.resolved_=Promise.resolve();this.taskCount_=0;this.canceled_={};this.startTime_=this.now()}x.prototype.now=function(){return Date.now()};x.prototype.timeSinceStart=function(){return this.now()-this.startTime_};x.prototype.delay=function(a,b){if(!b){var c=this,d="p"+this.taskCount_++;this.resolved_.then(function(){c.canceled_[d]?delete c.canceled_[d]:a()});return d}return this.win.setTimeout(a,b)};
x.prototype.cancel=function(a){"string"==typeof a?this.canceled_[a]=!0:this.win.clearTimeout(a)};x.prototype.promise=function(a,b){var c=this,d=null;return(new Promise(function(e,f){d=c.delay(function(){d=-1;e(b)},a);-1==d&&f(Error("Failed to schedule timer."))})).catch(function(a){-1!=d&&c.cancel(d);throw a;})};
x.prototype.timeoutPromise=function(a,b,c){var d=this,e=null,f=(new Promise(function(b,f){e=d.delay(function(){e=-1;f(u.createError(c||"timeout"))},a);-1==e&&f(Error("Failed to schedule timer."))})).catch(function(a){-1!=e&&d.cancel(e);throw a;});return b?Promise.race([f,b]):f};var y=new x(window);function z(a){return w(a,"vsync")};var A=Object.create(null),B="Webkit webkit Moz moz ms O o".split(" ");function D(a,b){for(var c in b){var d=a,e=b[c],f;f=d.style;var k=A[c];if(!k){k=c;if(void 0===f[c]){var n=c.charAt(0).toUpperCase()+c.slice(1),g=void 0;a:{for(g=0;g<B.length;g++){var v=B[g]+n;if(void 0!==f[v]){g=v;break a}}g=""}n=g;void 0!==f[n]&&(k=n)}A[c]=k}(f=k)&&(d.style[f]=e)}};function E(){this.handlers_=[]}E.prototype.add=function(a){var b=this;this.handlers_.push(a);return function(){b.remove(a)}};E.prototype.remove=function(a){for(var b=0;b<this.handlers_.length;b++)if(a==this.handlers_[b]){this.handlers_.splice(b,1);break}};E.prototype.fire=function(a){this.handlers_.forEach(function(b){b(a)})};E.prototype.getHandlerCount=function(){return this.handlers_.length};function F(a,b,c){1>b&&(b=1);var d=.5+Math.min(b/33.34,.5);return a/b*d+c*(1-d)};function G(a,b){this.handler_=a;this.defaultDelay_=b||0;this.scheduled_=-1;this.nextTime_=0;this.running_=!1}G.prototype.isPending=function(){return-1!=this.scheduled_};
G.prototype.schedule=function(a){a=a||this.defaultDelay_;this.running_&&10>a&&(a=10);var b=y.now()+a;if(-1==this.scheduled_||-10>b-this.nextTime_){var c=this;-1!=this.scheduled_&&y.cancel(this.scheduled_);this.nextTime_=b;this.scheduled_=y.delay(function(){c.scheduled_=-1;c.nextTime_=0;c.running_=!0;c.handler_();c.running_=!1},a);return!0}return!1};G.prototype.cancel=function(){-1!=this.scheduled_&&(y.cancel(this.scheduled_),this.scheduled_=-1)};function H(a,b,c,d){this.type=a;this.data=b;this.time=c;this.event=d}
function I(a){this.element_=a;this.recognizers_=[];this.tracking_=[];this.ready_=[];this.pending_=[];this.eventing_=null;this.wasEventing_=!1;this.pass_=new G(this.doPass_.bind(this));this.pointerDownObservable_=new E;this.overservers_=Object.create(null);this.boundOnTouchStart_=this.onTouchStart_.bind(this);this.boundOnTouchEnd_=this.onTouchEnd_.bind(this);this.boundOnTouchMove_=this.onTouchMove_.bind(this);this.boundOnTouchCancel_=this.onTouchCancel_.bind(this);this.element_.addEventListener("touchstart",
this.boundOnTouchStart_);this.element_.addEventListener("touchend",this.boundOnTouchEnd_);this.element_.addEventListener("touchmove",this.boundOnTouchMove_);this.element_.addEventListener("touchcancel",this.boundOnTouchCancel_)}function J(a){var b=a.__AMP_Gestures;b||(b=new I(a),a.__AMP_Gestures=b);return b}
I.prototype.cleanup=function(){this.element_.removeEventListener("touchstart",this.boundOnTouchStart_);this.element_.removeEventListener("touchend",this.boundOnTouchEnd_);this.element_.removeEventListener("touchmove",this.boundOnTouchMove_);this.element_.removeEventListener("touchcancel",this.boundOnTouchCancel_);this.pass_.cancel()};I.prototype.onGesture=function(a,b){var c=new a(this),d=c.getType(),e=this.overservers_[d];e||(this.recognizers_.push(c),e=new E,this.overservers_[d]=e);return e.add(b)};
I.prototype.onPointerDown=function(a){return this.pointerDownObservable_.add(a)};I.prototype.onTouchStart_=function(a){var b=y.now();this.wasEventing_=!1;this.pointerDownObservable_.fire(a);for(var c=0;c<this.recognizers_.length;c++)this.ready_[c]||(this.pending_[c]&&this.pending_[c]<b&&this.stopTracking_(c),this.recognizers_[c].onTouchStart(a)&&this.startTracking_(c));this.afterEvent_(a)};
I.prototype.onTouchMove_=function(a){for(var b=y.now(),c=0;c<this.recognizers_.length;c++)this.tracking_[c]&&(this.pending_[c]&&this.pending_[c]<b?this.stopTracking_(c):this.recognizers_[c].onTouchMove(a)||this.stopTracking_(c));this.afterEvent_(a)};
I.prototype.onTouchEnd_=function(a){for(var b=y.now(),c=0;c<this.recognizers_.length;c++)this.tracking_[c]&&(this.pending_[c]&&this.pending_[c]<b?this.stopTracking_(c):(this.recognizers_[c].onTouchEnd(a),(!this.pending_[c]||this.pending_[c]<b)&&this.stopTracking_(c)));this.afterEvent_(a)};I.prototype.onTouchCancel_=function(a){for(var b=0;b<this.recognizers_.length;b++)this.cancelEventing_(b);this.afterEvent_(a)};
I.prototype.signalReady_=function(a,b){if(this.eventing_)a.acceptCancel();else{for(var c=y.now(),d=0;d<this.recognizers_.length;d++)this.recognizers_[d]==a&&(this.ready_[d]=c+b,this.pending_[d]=0);this.passAfterEvent_=!0}};I.prototype.signalPending_=function(a,b){if(this.eventing_)a.acceptCancel();else for(var c=y.now(),d=0;d<this.recognizers_.length;d++)this.recognizers_[d]==a&&(this.pending_[d]=c+b)};I.prototype.signalEnd_=function(a){this.eventing_==a&&(this.eventing_=null,this.wasEventing_=!0)};
I.prototype.signalEmit_=function(a,b,c){var d=this.overservers_[a.getType()];d&&d.fire(new H(a.getType(),b,y.now(),c))};I.prototype.afterEvent_=function(a){var b=!!this.eventing_||this.wasEventing_;this.wasEventing_=!1;if(!b)for(var c=y.now(),d=0;d<this.recognizers_.length;d++)if(this.ready_[d]||this.pending_[d]&&this.pending_[d]>=c){b=!0;break}b&&(a.stopPropagation(),a.preventDefault());this.passAfterEvent_&&(this.passAfterEvent_=!1,this.doPass_())};
I.prototype.doPass_=function(){for(var a=y.now(),b=-1,c=0;c<this.recognizers_.length;c++)if(!this.ready_[c])this.pending_[c]&&this.pending_[c]<a&&this.stopTracking_(c);else if(-1==b||this.ready_[c]>this.ready_[b])b=c;if(-1!=b){for(var d=c=0;d<this.recognizers_.length;d++)!this.ready_[d]&&this.tracking_[d]&&(c=Math.max(c,this.pending_[d]-a));2>c?this.startEventing_(b):this.pass_.schedule(c)}};
I.prototype.startEventing_=function(a){for(var b=this.recognizers_[a],c=0;c<this.recognizers_.length;c++)c!=a&&this.cancelEventing_(c);this.ready_[a]=0;this.pending_[a]=0;this.eventing_=b;b.acceptStart()};I.prototype.startTracking_=function(a){this.tracking_[a]=!0;this.pending_[a]=0};I.prototype.stopTracking_=function(a){this.tracking_[a]=!1;this.pending_[a]=0;this.ready_[a]||this.recognizers_[a].acceptCancel()};I.prototype.cancelEventing_=function(a){this.ready_[a]=0;this.stopTracking_(a)};
function K(a,b){this.type_=a;this.manager_=b}K.prototype.getType=function(){return this.type_};K.prototype.signalReady=function(a){this.manager_.signalReady_(this,a)};K.prototype.signalPending=function(a){this.manager_.signalPending_(this,a)};K.prototype.signalEnd=function(){this.manager_.signalEnd_(this)};K.prototype.signalEmit=function(a,b){this.manager_.signalEmit_(this,a,b)};K.prototype.acceptStart=function(){};K.prototype.acceptCancel=function(){};K.prototype.onTouchStart=function(){return!1};
K.prototype.onTouchMove=function(){return!1};K.prototype.onTouchEnd=function(){};function L(a,b,c,d){K.call(this,a,b);this.horiz_=c;this.vert_=d;this.eventing_=!1;this.velocityY_=this.velocityX_=this.prevTime_=this.lastTime_=this.startTime_=this.prevY_=this.prevX_=this.lastY_=this.lastX_=this.startY_=this.startX_=0}l(L,K);L.prototype.onTouchStart=function(a){a=a.touches;if(!a||1!=a.length)return!1;this.startTime_=y.now();this.startX_=a[0].clientX;this.startY_=a[0].clientY;return!0};
L.prototype.onTouchMove=function(a){var b=a.changedTouches||a.touches;if(b&&1==b.length){var c=b[0].clientX,b=b[0].clientY;this.lastX_=c;this.lastY_=b;if(this.eventing_)this.emit_(!1,!1,a);else if(a=Math.abs(c-this.startX_),c=Math.abs(b-this.startY_),this.horiz_&&this.vert_)(8<=a||8<=c)&&this.signalReady(-10);else if(this.horiz_)if(8<=a&&a>c)this.signalReady(-10);else{if(8<=c)return!1}else if(this.vert_)if(8<=c&&c>a)this.signalReady(-10);else{if(8<=a)return!1}else return!1}return!0};
L.prototype.onTouchEnd=function(a){this.end_(a)};L.prototype.acceptStart=function(){this.eventing_=!0;this.prevX_=this.startX_;this.prevY_=this.startY_;this.prevTime_=this.startTime_;this.startX_=this.lastX_;this.startY_=this.lastY_;this.emit_(!0,!1,null)};L.prototype.acceptCancel=function(){this.eventing_=!1};
L.prototype.emit_=function(a,b,c){this.lastTime_=y.now();var d=this.lastTime_-this.prevTime_;if(!b&&4<d||b&&16<d)this.velocityX_=F(this.lastX_-this.prevX_,d,this.velocityX_),this.velocityY_=F(this.lastY_-this.prevY_,d,this.velocityY_),this.velocityX_=1E-4<Math.abs(this.velocityX_)?this.velocityX_:0,this.velocityY_=1E-4<Math.abs(this.velocityY_)?this.velocityY_:0,this.prevX_=this.lastX_,this.prevY_=this.lastY_,this.prevTime_=this.lastTime_;this.signalEmit({first:a,last:b,time:this.lastTime_,deltaX:this.horiz_?
this.lastX_-this.startX_:0,deltaY:this.vert_?this.lastY_-this.startY_:0,velocityX:this.horiz_?this.velocityX_:0,velocityY:this.vert_?this.velocityY_:0},c)};L.prototype.end_=function(a){this.eventing_&&(this.eventing_=!1,this.emit_(!1,!0,a),this.signalEnd())};function M(a){L.call(this,"swipe-xy",a,!0,!0)}l(M,L);function N(a){AMP.BaseElement.apply(this,arguments)}l(N,AMP.BaseElement);N.prototype.isLayoutSupported=function(a){return"nodisplay"==a};N.prototype.isReadyToBuild=function(){return!1};
N.prototype.buildCallback=function(){var a=this;D(this.element,{position:"fixed",zIndex:1E3,top:0,left:0,bottom:0,right:0});var b=this.getRealChildren();this.container_=this.element.ownerDocument.createElement("div");this.applyFillContent(this.container_);this.element.appendChild(this.container_);b.forEach(function(b){a.container_.appendChild(b)});this.registerAction("close",this.close.bind(this));J(this.element).onGesture(M,function(){});this.historyId_=-1};N.prototype.layoutCallback=function(){return Promise.resolve()};
N.prototype.activate=function(){var a=this;this.boundCloseOnEscape_=this.closeOnEscape_.bind(this);this.getWin().document.documentElement.addEventListener("keydown",this.boundCloseOnEscape_);this.requestFullOverlay();this.getViewport().resetTouchZoom();this.getViewport().hideFixedLayer();this.mutateElement(function(){a.element.style.display="";a.element.style.opacity=0;a.element.style.transition="opacity 0.1s ease-in";z(a.getWin()).mutate(function(){a.element.style.opacity=""})}).then(function(){a.updateInViewport(a.container_,
!0);a.scheduleLayout(a.container_)});this.getHistory_().push(this.close.bind(this)).then(function(b){a.historyId_=b})};N.prototype.closeOnEscape_=function(a){27==a.keyCode&&this.close()};N.prototype.close=function(){this.cancelFullOverlay();this.getViewport().showFixedLayer();this.element.style.display="none";-1!=this.historyId_&&this.getHistory_().pop(this.historyId_);this.getWin().document.documentElement.removeEventListener("keydown",this.boundCloseOnEscape_);this.boundCloseOnEscape_=null;this.schedulePause(this.container_)};
N.prototype.getHistory_=function(){return w(this.element.ownerDocument.defaultView,"history")};AMP.registerElement("amp-lightbox",N);
});
//# sourceMappingURL=amp-lightbox-0.1.js.map

